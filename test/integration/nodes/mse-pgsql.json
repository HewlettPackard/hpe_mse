{
  "id": "mse-pgsql",
  "chef_environment": "_default",
  "automatic": {
    "ipaddress": "168.63.56.240",
    "platform": "pgsql",
    "fqdn": "pgsql.mse.azure.k5cqibblib2u1n5qt2yn0u5wwc.fx.internal.cloudapp.net",
    "recipes": [
      "hpe_mse::base"
    ]
  },
  "normal": {
    "mse": {
      "install": {
        "isoUrl": "http://orgues.free.fr/tmp/mse/",
        "iso": {
          "engine": "TAS-3.1.0-12.019538.el7.iso",
          "product": [
            "P8070015.JPG",
            "P8120023.JPG",
            "P8120024.JPG"
          ]
        },
        "yumRepo": "centos*,updates*,base*",
        "sshKeysUrl": "http://orgues.free.fr/tmp/mse/"
      },
      "deploy": {
        "descriptor": "# -------------------------------------------------------------\n# MSE 2 nodes: ems and Pgsql database, refresh one node\n# MSE Descriptor generated by the builder 2018-08-02 Version 2.36\n# Build date: Sun Sep 09 2018 21:37:35 GMT+0200 (heure dÔÇÖ├®t├® dÔÇÖEurope centrale)\n# PRE REQUISISTES ON THE NODE RUNNING THE UNATTENDED NIVR SETUP\n# 1. The management network is up and running\n# 2.1 The command 'hostname' returns a fully qualified domain name used for node identification within the cluster\n# 2.2 The command 'hostname -i' returns the node IPV4 address on the MGMT network\n# OR\n# 2. /etc/sysconfig/network has a fully qualified domain name at the HOSTNAME entry\n# 3. MSE bits are available as:\n# 3.1 ISOs images on the file system in /var/opt/OC/iso or \n# 3.2 YUM repositories listed in YUM_REPO_LIST and IS_YUM_REPO=yes\n# -------------------------------------------------------------\n\n\n# ------------------------------- #\n# Network interfaces definition   #\n# ------------------------------- #\nMGMT_DEVICE=eth0\nMGMT_NETMASK=255.255.248.0\n\n# ------------------------------- #\n# Nodes and roles definition      #\n# ------------------------------- #\n\n# VNF Element Manager      #\nNIVR_EMS_NAME=ems.$(hostname -d)\nNIVR_EMS_IP_ADDR=<_%_= node['mse']['map']['ems']['ipaddress'] _%_>\n\n# ------------------------------- #\n# SEE Clusters                    #\n# ------------------------------- #\n# SEE Simplex      #\n# SEE Primary      #\n\n# SEE Secondary      #\n\n# SEE Witness      #\n\n# SEE additional nodes      #\n\n# HTTP Load Balancer Primary node   #\n\n# HTTP Load Balancer Secondary node   #\n\n# HTTP Load balancer virtual IP      #\nSEE_VIP_NAME=${VHTTP_NAME}\nRSLMF_VIP_NAME=${VHTTP_NAME}\n\n# Pgsql database\n# -Standalone: one single entry pointing to the Pgsql node\n# -Linux HA: one single entry defining the VIP of the Pgsql resource\n# -Static cluster: list of SEE nodes co-locating Pgsql, the first being the initial master\nPGSQL_HOST=( pgsql.$(hostname -d) )\nPGSQL_IP_ADDR=( <_%_= node['mse']['map']['pgsql']['ipaddress'] _%_> )\n\n#-------------------------------------------------#\n# Groups for service continuity upon upgrade\n# IP addresses preferred to address unresolved names\n#--------------------------------------------------#\nNIVR_REFRESH_SCHEDULE=(\n    <_%_= node['mse']['map']['pgsql']['ipaddress'] _%_> \\\n)\n\n# ------------------------------- #\n# Security                        #\n# ------------------------------- #\n# Certification authority for self signed certificates\nCERT_AUTH_ALIAS=\"nfvCert\"\n# Certification authority password\nCERT_AUTH_PASSWORD=\"nfvCert\"\n# Password for Linux HA administrator account (hacluster) and Redis access control; enforced for all Redis resources, default value: hacluster\nNIVRDB_LINUXHA_PASSWORD=\"hacluster\"\n\n# ------------------------------- #\n# Miscellaneous properties        #\n# ------------------------------- #\n# node collecting SNMP traps emitted by all the VNF members, typically the VNF EMS\nSNMP_TRAP_DESTINATION=\"${NIVR_EMS_IP_ADDR}\"\n# YUM repositories list\nYUM_REPO_LIST=centos*,updates*,base*\n[ \"$YUM_REPO_LIST\" != \"\" ] && IS_YUM_REPO=yes || IS_YUM_REPO=no\n\n# ------------------------ #\n# Redis Sentinel Instances #\n# ------------------------ #\n\n# ------------------------------- #\n#    OCSNF policy                 #\n# ------------------------------- #\n\n# ------------------------------- #\n#       Messaging Framework       #\n# ------------------------------- #\n\n# ------------------------------- #\n# Messaging Framework Application #\n# ------------------------------- #\n\n# ------------------------------- #\n#       Messaging Gateway       #\n# ------------------------------- #\n\n# ------------------------------- #\n#    Messaging Gateway Services   #\n# ------------------------------- #\n\n# ------------------------------- #\n# OCCP countries                  #\n# ------------------------------- #\n\n# ------------------------------- #\n# OCCP switching points           #\n# ------------------------------- #\n\n# ------------------------------- #\n# OCCP media servers              #\n# ------------------------------- #\n\n# ------------------------------- #\n#  TCAP connectivity providers    #\n# ------------------------------- #\n\n# ------------------------------- #\n# MRF adapters                    #\n# ------------------------------- #\n\n# ------------------------------- #\n# Diameter     providers          #\n# ------------------------------- #\n\n# ------------------------------- #\n# Ucp and Smpp providers          #\n# ------------------------------- #\n\n# ------------------------------- #\n# SMPP sessions                   #\n# ------------------------------- #\n\n# ------------------------------- #\n# SMPP profiles                   #\n# ------------------------------- #\n\n# ------------------------------- #\n# SMPP pairs                      #\n# ------------------------------- #\n\n# ------------------------------- #\n# JDBC and LDAP data sources      #\n# ------------------------------- #\n\n# ------------- #\n# LDAP profiles #\n# ------------- #\n\n# --------------- #\n# SOAP connectors #\n# --------------- #\n\n# ------------------------- #\n# SOAP Web Services Servers #\n# ------------------------- #\n\n# -----------------------#\n# SOAP Security Policies #\n# -----------------------#\n\n# ----------------- #\n# SOAP Web Services #\n# ----------------- #\n\n# ----------------- #\n# XMLRPC connectors #\n# ----------------- #\n\n# ----------------- #\n# XMLRPC Services   #\n# ----------------- #\n\n# ----------------- #\n# XMLRPC Servers    #\n# ----------------- #\n\n# ------------------------------- #\n# Activable Native Applications   #\n# ------------------------------- #\n# NIVR database type mysql|pgsql|oracle  \nACTIVATE_APPLI_NIVR=no\nACTIVATE_APPLI_CAASIVR=no\nACTIVATE_OCCP_SNTS=no\n\n# ------------------------------- #\n# WebRTC                           #\n# ------------------------------- #\n\n# ----------------- #\n# Licensing         #\n# ------------------#\n# SIP stack licensing serial number for SEE and OCMP\nSEE_SIP_SERIAL=\"0BCN04-z8jWFC-VWXYAA-VVVVAA-VUzVAD-VQNVEB\"\n# SIP stack licensing codeword for SEE and OCMP\nSEE_SIP_CODEWORD=\"0Emw03-z9pMFE-CDEF55-CCCC55-CDkC52-D2CC55-CeCC15\"\n# SIP stack licensing codeword for OCMP same as SEE\nOCMP_SIPLIC_SERIAL=${SEE_SIP_SERIAL}\nOCMP_SIPLIC_CODEWORD=${SEE_SIP_CODEWORD}\n\n\n# --------------------------------------------------- #\n# Node receiving outgoing calls from SMB WebRTC client\n# Default: the NFV installed SIP load balancer VIP \n# --------------------------------------------------- #\nWEBRTC_CALLEE_NAME=${VSIP_NAME}\nWEBRTC_CALLEE_IP_ADDR=${VSIP_IP_ADDR}\n\n# Optional list of RPM packages providing specific prompts\nAPP_PROMPTS=\"/var/opt/OC/iso/hpoc-smb-demo-prompts*.rpm\"\n\n# ------------------------------- #\n# Various database passwords \n# ------------------------------- #\n# pgsql\nNIVRDB_OCDBROOT_PASSWORD=ocdbroot\nNIVRDB_OCDBREP_PASSWORD=ocdbrep\nNIVRDB_OCDBADMIN_PASSWORD=ocdbadmin\nNIVRDB_OCDBACCESS_PASSWORD=ocdbaccess\nNIVRDB_APPADMIN_PASSWORD=appadmin\nNIVRDB_APPACCESS_PASSWORD=appaccess\n\n# mysql: force strong passwords\nif [[ \"$NIVR_DB_TYPE\" == \"mysql\" ]] ; then\nNIVRDB_ROOT_PASSWORD=HP1nvent!\nNIVRDB_OCDBACCESS_PASSWORD=${NIVRDB_ROOT_PASSWORD}\nNIVRDB_OCDBREP_PASSWORD=${NIVRDB_ROOT_PASSWORD}\nfi\n\n\n# oracle\nTPDM_TABLESPACE=NFVTPDM_TS\nAAA_TABLESPACE=NFVAAA_TS\nMCM_TABLESPACE=NFVMCM_TS\nMCS_TABLESPACE=NFVMCS_TS\nSMB_TABLESPACE=NFVSMB_TS\n\n# Reporting System \nNIVRDB_CCPS_DS_PASSWORD=CCPS_DS\nNIVRDB_CCPS_PASSWORD=CCPS\nNIVRDB_CCXML_PASSWORD=CCXML\nNIVRDB_EBRS_DS_PASSWORD=EBRS_DS\nNIVRDB_EBRS_QRTZ_PASSWORD=EBRS_QRTZ\nNIVRDB_EBRS_QRTZ_DS_PASSWORD=EBRS_QRTZ_DS\nNIVRDB_EBRS_PASSWORD=EBRS\nNIVRDB_JBOSS_JMS_PASSWORD=JBOSS_JMS\nNIVRDB_MSCML_PASSWORD=MSCML\nNIVRDB_REPORT_USER_PASSWORD=REPORT_USER\nNIVRDB_VXML_PASSWORD=CRYSTAL\nNIVRDB_QRTZ_DS_PASSWORD=QRTZ_DS\nNIVRDB_QRTZ_PASSWORD=QRTZ\n\n# ----------------------\n# USPM ISO image Details\n# ----------------------\nUSPM_ISO_PATH=$(ls /var/opt/OC/iso/USPM*.iso 2> /dev/null)\n\n# Enable refresh by not deleting root ssh keys at the end of installation\nRETAIN_SSH_KEYS_ROOT=YES\n\n#-------------------------------------------\n# Legacy management based on MSE connectors \n# Used to enable/disable features           \n#-------------------------------------------\n_legacySEE() {  command -v install-mse-connectors.sh install-mse_connectors.sh > /dev/null || test -f /var/opt/OC/iso/OpenCall-SEE*.iso && return 0 || return 1 ; }\n# NIVR and CaaS IVR: activate on SEE3 only\n# Messaging Framework, redis and all emscli resources: disable on SEE3\nif _legacySEE ; then\nMESSAGING_FRAMEWORK_SERVICE_COMPONENT_NAME=\nMESSAGING_GATEWAY_SERVICE_COMPONENT_NAME=\nACTIVATE_APPLI_MESSAGING_FRAMEWORK=no\nACTIVATE_APPLI_MESSAGING_GATEWAY=no\nTCAP_PROVIDER_NAME=()\nDIAMETER_SERVICE_COMPONENT_NAME=()\nUCP_PROVIDER_NAME=()\nSMPP_PROVIDER_NAME=()\nMRF_ADAPTER_SERVICE_COMPONENT_NAME=()\nDATASOURCE_NAME=()\nLDAP_PROFILE_NAME=()\nSOAP_SERVICE_COMPONENT_NAME=()\nSOAP_WSS_NAME=()\nSOAP_SECURITY_NAME=()\nSOAP_WS_NAME=()\nREDIS_HOST=()\nREDIS_IP_ADDR=()\nREDIS_INSTANCE_ID=()\nREDIS_PORT=()\nOCCP_SWITCHING_POINT=()\nOCCP_MEDIA_SERVER=()\nXMLRPC_SERVICE_COMPONENT_NAME=()\nXMLRPC_SERVICE=()\nXMLRPC_SERVER_ADDR=()\nelse\n# NIVR native applications supported only on PostgreSQL database without WebRTC on SEE > 3\nACTIVATE_APPLI_NIVR=$([[ $WEBRTC_SIGNALING_IP_ADDR == '' ]] && [[ $NIVR_DB_TYPE == 'pgsql' ]] && echo $ACTIVATE_APPLI_NIVR || echo no)\nACTIVATE_APPLI_CAASIVR=no\nACTIVATE_OCCP_SNTS=no\nfi\n\n# +++ EOF +++ # Do not delete this line\n"
      }
    }
  },
  "run_list": [
    "recipe[hpe_mse::base]"
  ]
}